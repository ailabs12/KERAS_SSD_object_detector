#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Tue Dec 25 09:35:15 2018
ВЫРЕЗКА ФРАГМЕНТОВ ИЗ КАДРОВ ВИДЕО (С МУСОРОВОЗАМИ)
@author: kdg-local
"""
import os
import json
import time
import base64
import requests

url = 'http://82.202.249.143:8002/ssd'
#my_req = {"image" : "data:image/jpeg;base64,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"}
headers = {'Content-Type': 'application/json'}

classes = ['bus', 'car', 'train', 'truck']
raw_dir = './RAW/'
crop_dir = './CROP/'
img_height = 300
img_width = 300

raw_imgs = os.listdir(path = raw_dir) 

""" Timing """
startTime = time.time()
resp_time = 0

for k in range(len(raw_imgs)):  # перебор сырых картинок в каталоге
    #img = image.load_img(raw_dir + k, target_size = (img_width, img_height))
    if k % 200 == 0: 
        print("Обработано " + str(k) + " images of " + str(len(raw_imgs)))
    with open(raw_dir + raw_imgs[k], "rb") as image_file:
        encoded_img = base64.b64encode(image_file.read())
    b64_data = "data:image/jpeg;base64," + encoded_img.decode()
    my_req = {"image" : b64_data }
    """ SSD over... """
    sTime = time.time()
    r = requests.post(url, data=json.dumps(my_req), headers=headers)
    resp_time += time.time() - sTime
    for i, obj in enumerate(r.json()['data']):
        if classes.count(obj['class']) : 
            with open(crop_dir + str(k) + str(i) + ".jpg", "wb") as jpg:
                jpg.write(base64.b64decode(obj['image'].split(',')[1]))
                
delta = time.time() - startTime
print("Elapsed time: {:.3f} sec".format(delta))  
print("mean Average time: {:.3f} sec".format(delta / len(raw_imgs))) 
print("mean Request/Response time: {:.3f} sec".format(resp_time / len(raw_imgs))) 
            
                
                